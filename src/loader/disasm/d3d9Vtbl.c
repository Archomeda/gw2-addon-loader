#include "d3d9Vtbl.h"

D3DDevice9Vtbl GetD3DDevice9Vtbl(const IDirect3DDevice9* const obj) {
    D3DDevice9Vtbl vtbl;
    vtbl.QueryInterface = obj->lpVtbl->QueryInterface;
    vtbl.AddRef = obj->lpVtbl->AddRef;
    vtbl.Release = obj->lpVtbl->Release;
    vtbl.TestCooperativeLevel = obj->lpVtbl->TestCooperativeLevel;
    vtbl.GetAvailableTextureMem = obj->lpVtbl->GetAvailableTextureMem;
    vtbl.EvictManagedResources = obj->lpVtbl->EvictManagedResources;
    vtbl.GetDirect3D = obj->lpVtbl->GetDirect3D;
    vtbl.GetDeviceCaps = obj->lpVtbl->GetDeviceCaps;
    vtbl.GetDisplayMode = obj->lpVtbl->GetDisplayMode;
    vtbl.GetCreationParameters = obj->lpVtbl->GetCreationParameters;
    vtbl.SetCursorProperties = obj->lpVtbl->SetCursorProperties;
    vtbl.SetCursorPosition = obj->lpVtbl->SetCursorPosition;
    vtbl.ShowCursor = obj->lpVtbl->ShowCursor;
    vtbl.CreateAdditionalSwapChain = obj->lpVtbl->CreateAdditionalSwapChain;
    vtbl.GetSwapChain = obj->lpVtbl->GetSwapChain;
    vtbl.GetNumberOfSwapChains = obj->lpVtbl->GetNumberOfSwapChains;
    vtbl.Reset = obj->lpVtbl->Reset;
    vtbl.Present = obj->lpVtbl->Present;
    vtbl.GetBackBuffer = obj->lpVtbl->GetBackBuffer;
    vtbl.GetRasterStatus = obj->lpVtbl->GetRasterStatus;
    vtbl.SetDialogBoxMode = obj->lpVtbl->SetDialogBoxMode;
    vtbl.SetGammaRamp = obj->lpVtbl->SetGammaRamp;
    vtbl.GetGammaRamp = obj->lpVtbl->GetGammaRamp;
    vtbl.CreateTexture = obj->lpVtbl->CreateTexture;
    vtbl.CreateVolumeTexture = obj->lpVtbl->CreateVolumeTexture;
    vtbl.CreateCubeTexture = obj->lpVtbl->CreateCubeTexture;
    vtbl.CreateVertexBuffer = obj->lpVtbl->CreateVertexBuffer;
    vtbl.CreateIndexBuffer = obj->lpVtbl->CreateIndexBuffer;
    vtbl.CreateRenderTarget = obj->lpVtbl->CreateRenderTarget;
    vtbl.CreateDepthStencilSurface = obj->lpVtbl->CreateDepthStencilSurface;
    vtbl.UpdateSurface = obj->lpVtbl->UpdateSurface;
    vtbl.UpdateTexture = obj->lpVtbl->UpdateTexture;
    vtbl.GetRenderTargetData = obj->lpVtbl->GetRenderTargetData;
    vtbl.GetFrontBufferData = obj->lpVtbl->GetFrontBufferData;
    vtbl.StretchRect = obj->lpVtbl->StretchRect;
    vtbl.ColorFill = obj->lpVtbl->ColorFill;
    vtbl.CreateOffscreenPlainSurface = obj->lpVtbl->CreateOffscreenPlainSurface;
    vtbl.SetRenderTarget = obj->lpVtbl->SetRenderTarget;
    vtbl.GetRenderTarget = obj->lpVtbl->GetRenderTarget;
    vtbl.SetDepthStencilSurface = obj->lpVtbl->SetDepthStencilSurface;
    vtbl.GetDepthStencilSurface = obj->lpVtbl->GetDepthStencilSurface;
    vtbl.BeginScene = obj->lpVtbl->BeginScene;
    vtbl.EndScene = obj->lpVtbl->EndScene;
    vtbl.Clear = obj->lpVtbl->Clear;
    vtbl.SetTransform = obj->lpVtbl->SetTransform;
    vtbl.GetTransform = obj->lpVtbl->GetTransform;
    vtbl.MultiplyTransform = obj->lpVtbl->MultiplyTransform;
    vtbl.SetViewport = obj->lpVtbl->SetViewport;
    vtbl.GetViewport = obj->lpVtbl->GetViewport;
    vtbl.SetMaterial = obj->lpVtbl->SetMaterial;
    vtbl.GetMaterial = obj->lpVtbl->GetMaterial;
    vtbl.SetLight = obj->lpVtbl->SetLight;
    vtbl.GetLight = obj->lpVtbl->GetLight;
    vtbl.LightEnable = obj->lpVtbl->LightEnable;
    vtbl.GetLightEnable = obj->lpVtbl->GetLightEnable;
    vtbl.SetClipPlane = obj->lpVtbl->SetClipPlane;
    vtbl.GetClipPlane = obj->lpVtbl->GetClipPlane;
    vtbl.SetRenderState = obj->lpVtbl->SetRenderState;
    vtbl.GetRenderState = obj->lpVtbl->GetRenderState;
    vtbl.CreateStateBlock = obj->lpVtbl->CreateStateBlock;
    vtbl.BeginStateBlock = obj->lpVtbl->BeginStateBlock;
    vtbl.EndStateBlock = obj->lpVtbl->EndStateBlock;
    vtbl.SetClipStatus = obj->lpVtbl->SetClipStatus;
    vtbl.GetClipStatus = obj->lpVtbl->GetClipStatus;
    vtbl.GetTexture = obj->lpVtbl->GetTexture;
    vtbl.SetTexture = obj->lpVtbl->SetTexture;
    vtbl.GetTextureStageState = obj->lpVtbl->GetTextureStageState;
    vtbl.SetTextureStageState = obj->lpVtbl->SetTextureStageState;
    vtbl.GetSamplerState = obj->lpVtbl->GetSamplerState;
    vtbl.SetSamplerState = obj->lpVtbl->SetSamplerState;
    vtbl.ValidateDevice = obj->lpVtbl->ValidateDevice;
    vtbl.SetPaletteEntries = obj->lpVtbl->SetPaletteEntries;
    vtbl.GetPaletteEntries = obj->lpVtbl->GetPaletteEntries;
    vtbl.SetCurrentTexturePalette = obj->lpVtbl->SetCurrentTexturePalette;
    vtbl.GetCurrentTexturePalette = obj->lpVtbl->GetCurrentTexturePalette;
    vtbl.SetScissorRect = obj->lpVtbl->SetScissorRect;
    vtbl.GetScissorRect = obj->lpVtbl->GetScissorRect;
    vtbl.SetSoftwareVertexProcessing = obj->lpVtbl->SetSoftwareVertexProcessing;
    vtbl.GetSoftwareVertexProcessing = obj->lpVtbl->GetSoftwareVertexProcessing;
    vtbl.SetNPatchMode = obj->lpVtbl->SetNPatchMode;
    vtbl.GetNPatchMode = obj->lpVtbl->GetNPatchMode;
    vtbl.DrawPrimitive = obj->lpVtbl->DrawPrimitive;
    vtbl.DrawIndexedPrimitive = obj->lpVtbl->DrawIndexedPrimitive;
    vtbl.DrawPrimitiveUP = obj->lpVtbl->DrawPrimitiveUP;
    vtbl.DrawIndexedPrimitiveUP = obj->lpVtbl->DrawIndexedPrimitiveUP;
    vtbl.ProcessVertices = obj->lpVtbl->ProcessVertices;
    vtbl.CreateVertexDeclaration = obj->lpVtbl->CreateVertexDeclaration;
    vtbl.SetVertexDeclaration = obj->lpVtbl->SetVertexDeclaration;
    vtbl.GetVertexDeclaration = obj->lpVtbl->GetVertexDeclaration;
    vtbl.SetFVF = obj->lpVtbl->SetFVF;
    vtbl.GetFVF = obj->lpVtbl->GetFVF;
    vtbl.CreateVertexShader = obj->lpVtbl->CreateVertexShader;
    vtbl.SetVertexShader = obj->lpVtbl->SetVertexShader;
    vtbl.GetVertexShader = obj->lpVtbl->GetVertexShader;
    vtbl.SetVertexShaderConstantF = obj->lpVtbl->SetVertexShaderConstantF;
    vtbl.GetVertexShaderConstantF = obj->lpVtbl->GetVertexShaderConstantF;
    vtbl.SetVertexShaderConstantI = obj->lpVtbl->SetVertexShaderConstantI;
    vtbl.GetVertexShaderConstantI = obj->lpVtbl->GetVertexShaderConstantI;
    vtbl.SetVertexShaderConstantB = obj->lpVtbl->SetVertexShaderConstantB;
    vtbl.GetVertexShaderConstantB = obj->lpVtbl->GetVertexShaderConstantB;
    vtbl.SetStreamSource = obj->lpVtbl->SetStreamSource;
    vtbl.GetStreamSource = obj->lpVtbl->GetStreamSource;
    vtbl.SetStreamSourceFreq = obj->lpVtbl->SetStreamSourceFreq;
    vtbl.GetStreamSourceFreq = obj->lpVtbl->GetStreamSourceFreq;
    vtbl.SetIndices = obj->lpVtbl->SetIndices;
    vtbl.GetIndices = obj->lpVtbl->GetIndices;
    vtbl.CreatePixelShader = obj->lpVtbl->CreatePixelShader;
    vtbl.SetPixelShader = obj->lpVtbl->SetPixelShader;
    vtbl.GetPixelShader = obj->lpVtbl->GetPixelShader;
    vtbl.SetPixelShaderConstantF = obj->lpVtbl->SetPixelShaderConstantF;
    vtbl.GetPixelShaderConstantF = obj->lpVtbl->GetPixelShaderConstantF;
    vtbl.SetPixelShaderConstantI = obj->lpVtbl->SetPixelShaderConstantI;
    vtbl.GetPixelShaderConstantI = obj->lpVtbl->GetPixelShaderConstantI;
    vtbl.SetPixelShaderConstantB = obj->lpVtbl->SetPixelShaderConstantB;
    vtbl.GetPixelShaderConstantB = obj->lpVtbl->GetPixelShaderConstantB;
    vtbl.DrawRectPatch = obj->lpVtbl->DrawRectPatch;
    vtbl.DrawTriPatch = obj->lpVtbl->DrawTriPatch;
    vtbl.DeletePatch = obj->lpVtbl->DeletePatch;
    vtbl.CreateQuery = obj->lpVtbl->CreateQuery;
    return vtbl;
}

void SetD3DDevice9Vtbl(IDirect3DDevice9* const obj, const D3DDevice9Vtbl vtbl) {
    DWORD protection = PAGE_READWRITE;
    if (VirtualProtect(obj->lpVtbl, sizeof(*obj->lpVtbl), protection, &protection)) {
        obj->lpVtbl->QueryInterface = vtbl.QueryInterface;
        obj->lpVtbl->AddRef = vtbl.AddRef;
        obj->lpVtbl->Release = vtbl.Release;
        obj->lpVtbl->TestCooperativeLevel = vtbl.TestCooperativeLevel;
        obj->lpVtbl->GetAvailableTextureMem = vtbl.GetAvailableTextureMem;
        obj->lpVtbl->EvictManagedResources = vtbl.EvictManagedResources;
        obj->lpVtbl->GetDirect3D = vtbl.GetDirect3D;
        obj->lpVtbl->GetDeviceCaps = vtbl.GetDeviceCaps;
        obj->lpVtbl->GetDisplayMode = vtbl.GetDisplayMode;
        obj->lpVtbl->GetCreationParameters = vtbl.GetCreationParameters;
        obj->lpVtbl->SetCursorProperties = vtbl.SetCursorProperties;
        obj->lpVtbl->SetCursorPosition = vtbl.SetCursorPosition;
        obj->lpVtbl->ShowCursor = vtbl.ShowCursor;
        obj->lpVtbl->CreateAdditionalSwapChain = vtbl.CreateAdditionalSwapChain;
        obj->lpVtbl->GetSwapChain = vtbl.GetSwapChain;
        obj->lpVtbl->GetNumberOfSwapChains = vtbl.GetNumberOfSwapChains;
        obj->lpVtbl->Reset = vtbl.Reset;
        obj->lpVtbl->Present = vtbl.Present;
        obj->lpVtbl->GetBackBuffer = vtbl.GetBackBuffer;
        obj->lpVtbl->GetRasterStatus = vtbl.GetRasterStatus;
        obj->lpVtbl->SetDialogBoxMode = vtbl.SetDialogBoxMode;
        obj->lpVtbl->SetGammaRamp = vtbl.SetGammaRamp;
        obj->lpVtbl->GetGammaRamp = vtbl.GetGammaRamp;
        obj->lpVtbl->CreateTexture = vtbl.CreateTexture;
        obj->lpVtbl->CreateVolumeTexture = vtbl.CreateVolumeTexture;
        obj->lpVtbl->CreateCubeTexture = vtbl.CreateCubeTexture;
        obj->lpVtbl->CreateVertexBuffer = vtbl.CreateVertexBuffer;
        obj->lpVtbl->CreateIndexBuffer = vtbl.CreateIndexBuffer;
        obj->lpVtbl->CreateRenderTarget = vtbl.CreateRenderTarget;
        obj->lpVtbl->CreateDepthStencilSurface = vtbl.CreateDepthStencilSurface;
        obj->lpVtbl->UpdateSurface = vtbl.UpdateSurface;
        obj->lpVtbl->UpdateTexture = vtbl.UpdateTexture;
        obj->lpVtbl->GetRenderTargetData = vtbl.GetRenderTargetData;
        obj->lpVtbl->GetFrontBufferData = vtbl.GetFrontBufferData;
        obj->lpVtbl->StretchRect = vtbl.StretchRect;
        obj->lpVtbl->ColorFill = vtbl.ColorFill;
        obj->lpVtbl->CreateOffscreenPlainSurface = vtbl.CreateOffscreenPlainSurface;
        obj->lpVtbl->SetRenderTarget = vtbl.SetRenderTarget;
        obj->lpVtbl->GetRenderTarget = vtbl.GetRenderTarget;
        obj->lpVtbl->SetDepthStencilSurface = vtbl.SetDepthStencilSurface;
        obj->lpVtbl->GetDepthStencilSurface = vtbl.GetDepthStencilSurface;
        obj->lpVtbl->BeginScene = vtbl.BeginScene;
        obj->lpVtbl->EndScene = vtbl.EndScene;
        obj->lpVtbl->Clear = vtbl.Clear;
        obj->lpVtbl->SetTransform = vtbl.SetTransform;
        obj->lpVtbl->GetTransform = vtbl.GetTransform;
        obj->lpVtbl->MultiplyTransform = vtbl.MultiplyTransform;
        obj->lpVtbl->SetViewport = vtbl.SetViewport;
        obj->lpVtbl->GetViewport = vtbl.GetViewport;
        obj->lpVtbl->SetMaterial = vtbl.SetMaterial;
        obj->lpVtbl->GetMaterial = vtbl.GetMaterial;
        obj->lpVtbl->SetLight = vtbl.SetLight;
        obj->lpVtbl->GetLight = vtbl.GetLight;
        obj->lpVtbl->LightEnable = vtbl.LightEnable;
        obj->lpVtbl->GetLightEnable = vtbl.GetLightEnable;
        obj->lpVtbl->SetClipPlane = vtbl.SetClipPlane;
        obj->lpVtbl->GetClipPlane = vtbl.GetClipPlane;
        obj->lpVtbl->SetRenderState = vtbl.SetRenderState;
        obj->lpVtbl->GetRenderState = vtbl.GetRenderState;
        obj->lpVtbl->CreateStateBlock = vtbl.CreateStateBlock;
        obj->lpVtbl->BeginStateBlock = vtbl.BeginStateBlock;
        obj->lpVtbl->EndStateBlock = vtbl.EndStateBlock;
        obj->lpVtbl->SetClipStatus = vtbl.SetClipStatus;
        obj->lpVtbl->GetClipStatus = vtbl.GetClipStatus;
        obj->lpVtbl->GetTexture = vtbl.GetTexture;
        obj->lpVtbl->SetTexture = vtbl.SetTexture;
        obj->lpVtbl->GetTextureStageState = vtbl.GetTextureStageState;
        obj->lpVtbl->SetTextureStageState = vtbl.SetTextureStageState;
        obj->lpVtbl->GetSamplerState = vtbl.GetSamplerState;
        obj->lpVtbl->SetSamplerState = vtbl.SetSamplerState;
        obj->lpVtbl->ValidateDevice = vtbl.ValidateDevice;
        obj->lpVtbl->SetPaletteEntries = vtbl.SetPaletteEntries;
        obj->lpVtbl->GetPaletteEntries = vtbl.GetPaletteEntries;
        obj->lpVtbl->SetCurrentTexturePalette = vtbl.SetCurrentTexturePalette;
        obj->lpVtbl->GetCurrentTexturePalette = vtbl.GetCurrentTexturePalette;
        obj->lpVtbl->SetScissorRect = vtbl.SetScissorRect;
        obj->lpVtbl->GetScissorRect = vtbl.GetScissorRect;
        obj->lpVtbl->SetSoftwareVertexProcessing = vtbl.SetSoftwareVertexProcessing;
        obj->lpVtbl->GetSoftwareVertexProcessing = vtbl.GetSoftwareVertexProcessing;
        obj->lpVtbl->SetNPatchMode = vtbl.SetNPatchMode;
        obj->lpVtbl->GetNPatchMode = vtbl.GetNPatchMode;
        obj->lpVtbl->DrawPrimitive = vtbl.DrawPrimitive;
        obj->lpVtbl->DrawIndexedPrimitive = vtbl.DrawIndexedPrimitive;
        obj->lpVtbl->DrawPrimitiveUP = vtbl.DrawPrimitiveUP;
        obj->lpVtbl->DrawIndexedPrimitiveUP = vtbl.DrawIndexedPrimitiveUP;
        obj->lpVtbl->ProcessVertices = vtbl.ProcessVertices;
        obj->lpVtbl->CreateVertexDeclaration = vtbl.CreateVertexDeclaration;
        obj->lpVtbl->SetVertexDeclaration = vtbl.SetVertexDeclaration;
        obj->lpVtbl->GetVertexDeclaration = vtbl.GetVertexDeclaration;
        obj->lpVtbl->SetFVF = vtbl.SetFVF;
        obj->lpVtbl->GetFVF = vtbl.GetFVF;
        obj->lpVtbl->CreateVertexShader = vtbl.CreateVertexShader;
        obj->lpVtbl->SetVertexShader = vtbl.SetVertexShader;
        obj->lpVtbl->GetVertexShader = vtbl.GetVertexShader;
        obj->lpVtbl->SetVertexShaderConstantF = vtbl.SetVertexShaderConstantF;
        obj->lpVtbl->GetVertexShaderConstantF = vtbl.GetVertexShaderConstantF;
        obj->lpVtbl->SetVertexShaderConstantI = vtbl.SetVertexShaderConstantI;
        obj->lpVtbl->GetVertexShaderConstantI = vtbl.GetVertexShaderConstantI;
        obj->lpVtbl->SetVertexShaderConstantB = vtbl.SetVertexShaderConstantB;
        obj->lpVtbl->GetVertexShaderConstantB = vtbl.GetVertexShaderConstantB;
        obj->lpVtbl->SetStreamSource = vtbl.SetStreamSource;
        obj->lpVtbl->GetStreamSource = vtbl.GetStreamSource;
        obj->lpVtbl->SetStreamSourceFreq = vtbl.SetStreamSourceFreq;
        obj->lpVtbl->GetStreamSourceFreq = vtbl.GetStreamSourceFreq;
        obj->lpVtbl->SetIndices = vtbl.SetIndices;
        obj->lpVtbl->GetIndices = vtbl.GetIndices;
        obj->lpVtbl->CreatePixelShader = vtbl.CreatePixelShader;
        obj->lpVtbl->SetPixelShader = vtbl.SetPixelShader;
        obj->lpVtbl->GetPixelShader = vtbl.GetPixelShader;
        obj->lpVtbl->SetPixelShaderConstantF = vtbl.SetPixelShaderConstantF;
        obj->lpVtbl->GetPixelShaderConstantF = vtbl.GetPixelShaderConstantF;
        obj->lpVtbl->SetPixelShaderConstantI = vtbl.SetPixelShaderConstantI;
        obj->lpVtbl->GetPixelShaderConstantI = vtbl.GetPixelShaderConstantI;
        obj->lpVtbl->SetPixelShaderConstantB = vtbl.SetPixelShaderConstantB;
        obj->lpVtbl->GetPixelShaderConstantB = vtbl.GetPixelShaderConstantB;
        obj->lpVtbl->DrawRectPatch = vtbl.DrawRectPatch;
        obj->lpVtbl->DrawTriPatch = vtbl.DrawTriPatch;
        obj->lpVtbl->DeletePatch = vtbl.DeletePatch;
        obj->lpVtbl->CreateQuery = vtbl.CreateQuery;
        VirtualProtect(obj->lpVtbl, sizeof(*obj->lpVtbl), protection, &protection);
    }
}
